# R2Lang - Lenguaje de Programaci√≥n Moderno

## Descripci√≥n General

R2Lang es un lenguaje de programaci√≥n interpretado que combina la sintaxis familiar de JavaScript con caracter√≠sticas modernas como orientaci√≥n a objetos, concurrencia nativa, sistema de testing integrado, y **nuestro innovador sistema DSL** para crear lenguajes espec√≠ficos de dominio de forma elegante y sencilla.

## ‚ú® Caracter√≠sticas Principales

### üåü Constructor de DSL - Nuestra Caracter√≠stica M√°s Original

**El sistema DSL de R2Lang es nuestra caracter√≠stica m√°s innovadora**, permitiendo crear lenguajes espec√≠ficos de dominio con una sintaxis elegante y simple. Esto diferencia a R2Lang de otros lenguajes al hacer que la creaci√≥n de parsers sea tan f√°cil como escribir una funci√≥n.

#### ¬øPor qu√© nuestro DSL es especial?

A diferencia de generadores de parsers complejos como ANTLR o Lex/Yacc, el sistema DSL de R2Lang es:
- **Integraci√≥n Nativa**: El c√≥digo DSL se ejecuta directamente en R2Lang
- **Configuraci√≥n Cero**: Sin herramientas externas o generaci√≥n de c√≥digo
- **Sintaxis Intuitiva**: Declarativa y legible
- **Resultados Instant√°neos**: De la idea a un parser funcional en minutos

#### Ejemplo R√°pido de DSL

```r2
// Definir un DSL de calculadora simple
dsl Calculadora {
    token("NUMERO", "[0-9]+")
    token("SUMA", "\\+")
    token("RESTA", "-")
    token("MULT", "\\*")
    token("DIV", "/")
    
    rule("operacion", ["NUMERO", "operador", "NUMERO"], "calcular")
    rule("operador", ["SUMA"], "op_suma")
    rule("operador", ["RESTA"], "op_resta")
    rule("operador", ["MULT"], "op_mult")
    rule("operador", ["DIV"], "op_div")
    
    func calcular(izq, op, der) {
        var a = parseFloat(izq)
        var b = parseFloat(der)
        
        if (op == "+") return a + b
        if (op == "-") return a - b
        if (op == "*") return a * b
        if (op == "/") return a / b
    }
    
    func op_suma(token) { return "+" }
    func op_resta(token) { return "-" }
    func op_mult(token) { return "*" }
    func op_div(token) { return "/" }
}

// Usar tu DSL
func main() {
    var calc = Calculadora.use
    
    var resultado = calc("15 + 25")
    console.log(resultado.Output)  // 40
    
    console.log(resultado)  // "DSL[15 + 25] -> 40"
}
```

#### DSL vs Parsers Tradicionales

| Caracter√≠stica | R2Lang DSL | ANTLR | Lex/Yacc |
|----------------|------------|-------|-----------|
| **Tiempo de Setup** | Minutos | Horas | D√≠as |
| **Generaci√≥n de C√≥digo** | Ninguna | Requerida | Requerida |
| **Curva de Aprendizaje** | M√≠nima | Empinada | Muy Empinada |
| **Integraci√≥n** | Nativa | Externa | Externa |
| **Debugging** | Herramientas R2Lang | Especializado | Complejo |
| **Acceso a Resultados** | `resultado.Output` | C√≥digo generado | C√≥digo generado |

#### Casos de Uso del DSL

- **Lenguajes de Configuraci√≥n**: Formatos de archivos de configuraci√≥n personalizados
- **Sistemas de Comandos**: Lenguajes de comandos espec√≠ficos de dominio
- **Validadores de Datos**: Reglas de validaci√≥n personalizadas
- **Procesadores de Texto**: Parseo de texto especializado
- **Reglas de Negocio**: L√≥gica de negocio espec√≠fica de dominio

#### Aprende M√°s

- [**Documentaci√≥n Completa del DSL**](./dsl/) - Gu√≠a completa y ejemplos
- [**Ejemplos de DSL**](../../examples/dsl/) - Ejemplos de calculadora y comandos
- [**Referencia R√°pida DSL**](./dsl/referencia_rapida.md) - Gu√≠a de referencia r√°pida

---

### üöÄ Sintaxis Intuitiva
```r2
func main() {
    let mensaje = "¬°Hola, R2Lang!"
    print(mensaje)
}
```

### üéØ Orientaci√≥n a Objetos con Herencia
```r2
class Persona {
    let nombre
    let edad
    
    constructor(nombre, edad) {
        this.nombre = nombre
        this.edad = edad
    }
    
    saludar() {
        print("Hola, soy " + this.nombre)
    }
}

class Empleado extends Persona {
    let salario
    
    constructor(nombre, edad, salario) {
        super.constructor(nombre, edad)
        this.salario = salario
    }
    
    trabajar() {
        print(this.nombre + " est√° trabajando")
    }
}
```

### ‚ö° Concurrencia Nativa
```r2
func tarea() {
    print("Ejecutando en paralelo")
    sleep(1)
    print("Tarea completada")
}

func main() {
    r2(tarea)  // Ejecuta en goroutine
    r2(tarea)
    sleep(2)   // Esperar completaci√≥n
}
```

### üß™ Sistema de Testing Integrado
```r2
TestCase "Verificar Suma" {
    Given func() { 
        setup()
        return "Preparando datos"
    }
    When func() {
        let resultado = 2 + 3
        return "Ejecutando operaci√≥n"
    }
    Then func() {
        assertEqual(resultado, 5)
        return "Validando resultado"
    }
}
```

### üì¶ Sistema de M√≥dulos
```r2
import "math.r2" as math
import "./utils.r2" as utils

func main() {
    let resultado = math.sqrt(16)
    utils.log("Resultado: " + resultado)
}
```

## Instalaci√≥n

### Requisitos Previos
- Go 1.23.4 o superior
- Git

### Clonar e Instalar
```bash
git clone https://github.com/arturoeanton/go-r2lang.git
cd go-r2lang
go build -o r2lang main.go
```

### Ejecutar Programas
```bash
# Ejecutar un archivo R2
./r2lang programa.r2

# Ejecutar main.r2 del directorio actual
./r2lang

# Modo interactivo REPL
./r2lang -repl

# REPL sin salida de debug
./r2lang -repl -no-output
```

## Ejemplos de C√≥digo

### Variables y Tipos
```r2
let numero = 42
let texto = "Hola mundo"
let bandera = true
let arreglo = [1, 2, 3, "cuatro"]
let mapa = {
    nombre: "Juan",
    edad: 30,
    activo: true
}
```

### Control de Flujo
```r2
// Condicionales
if (edad >= 18) {
    print("Mayor de edad")
} else {
    print("Menor de edad")
}

// Bucles
for (let i = 0; i < 10; i++) {
    print("Iteraci√≥n: " + i)
}

// For-in para arreglos
for (let item in arreglo) {
    print("Item: " + item)
}

// While
let contador = 0
while (contador < 5) {
    print("Contador: " + contador)
    contador++
}
```

### Funciones y Lambdas
```r2
func sumar(a, b) {
    return a + b
}

// Funci√≥n lambda
let multiplicar = func(a, b) {
    return a * b
}

// Funci√≥n de orden superior
let numeros = [1, 2, 3, 4, 5]
let duplicados = numeros.map(func(x) { return x * 2 })
```

### Manejo de Errores
```r2
try {
    let resultado = dividir(10, 0)
    print("Resultado: " + resultado)
} catch (error) {
    print("Error: " + error)
} finally {
    print("Limpieza completada")
}
```

### Arrays y Operaciones
```r2
let frutas = ["manzana", "banana", "naranja"]

// M√©todos de arrays
frutas.push("uva")                    // Agregar elemento
let longitud = frutas.len()           // Obtener longitud
let encontrado = frutas.find("banana") // Buscar elemento
let filtradas = frutas.filter(func(f) { 
    return f.length > 5 
})

// Operaciones funcionales
let numeros = [1, 2, 3, 4, 5]
let suma = numeros.reduce(func(acc, val) { 
    return acc + val 
})
let ordenados = numeros.sort()
```

## Bibliotecas Integradas

### Est√°ndar
- `print()` - Salida por consola
- `len()` - Longitud de strings/arrays
- `typeOf()` - Tipo de variable
- `sleep()` - Pausa en segundos

### Matem√°ticas
- `math.sqrt()`, `math.pow()`, `math.sin()`, etc.
- `rand.int()`, `rand.float()` - N√∫meros aleatorios

### I/O y Sistema
- `io.readFile()`, `io.writeFile()` - Operaciones de archivo
- `os.getEnv()`, `os.exit()` - Interacci√≥n con SO

### HTTP
```r2
// Servidor HTTP
http.server(8080, func(req, res) {
    res.json({mensaje: "¬°Hola desde R2Lang!"})
})

// Cliente HTTP
let respuesta = httpClient.get("https://api.ejemplo.com")
print(respuesta.body)
```

### Strings
```r2
let texto = "Hola Mundo"
let mayusculas = texto.upper()
let palabras = texto.split(" ")
let contiene = texto.contains("Mundo")
```

## Arquitectura del Int√©rprete

### Componentes Principales

1. **Lexer** (`r2lang/r2lang.go:139-321`)
   - Tokenizaci√≥n del c√≥digo fuente
   - Manejo de n√∫meros, strings, operadores
   - Soporte para comentarios de l√≠nea y bloque

2. **Parser** (`r2lang/r2lang.go:1662-2331`)
   - An√°lisis sint√°ctico recursivo descendente
   - Construcci√≥n del AST (Abstract Syntax Tree)
   - Manejo de precedencia de operadores

3. **AST y Evaluaci√≥n** (`r2lang/r2lang.go:327-1657`)
   - Nodos del AST implementan interfaz `Node`
   - Tree-walking interpreter
   - Evaluaci√≥n lazy de expresiones

4. **Environment** (`r2lang/r2lang.go:1429-1507`)
   - Sistema de scoping con environments anidados
   - Gesti√≥n de variables y funciones
   - Closure support

5. **Bibliotecas Nativas** (`r2lang/r2*.go`)
   - Funciones integradas en Go
   - Extensi√≥n modular del lenguaje

## Casos de Uso

### Scripting y Automatizaci√≥n
```r2
// Procesamiento de archivos
let contenido = io.readFile("datos.txt")
let lineas = contenido.split("\n")
let procesadas = lineas.map(func(linea) {
    return linea.trim().upper()
})
io.writeFile("salida.txt", procesadas.join("\n"))
```

### APIs y Microservicios
```r2
func manejarUsuarios(req, res) {
    if (req.method == "GET") {
        res.json(obtenerUsuarios())
    } else if (req.method == "POST") {
        let usuario = req.body
        crearUsuario(usuario)
        res.status(201).json({mensaje: "Usuario creado"})
    }
}

http.server(3000, manejarUsuarios)
```

### Testing y QA
```r2
TestCase "API de Usuarios" {
    Given func() {
        limpiarBaseDatos()
        return "Base de datos limpia"
    }
    When func() {
        let respuesta = httpClient.post("/api/usuarios", {
            nombre: "Juan",
            email: "juan@ejemplo.com"
        })
        return "Usuario creado via API"
    }
    Then func() {
        assertEqual(respuesta.status, 201)
        assertTrue(respuesta.body.id != null)
        return "Respuesta v√°lida"
    }
}
```

## Roadmap

### Version 1.0 (Actual)
- ‚úÖ Int√©rprete b√°sico funcional
- ‚úÖ Orientaci√≥n a objetos con herencia
- ‚úÖ Concurrencia con goroutines
- ‚úÖ Sistema de testing integrado
- ‚úÖ Bibliotecas b√°sicas (I/O, HTTP, Math)

### Version 1.1 (Q1 2024)
- üîÑ Sistema de tipos mejorado
- üîÑ Manejo de errores robusto
- üîÑ Debugger integrado
- üîÑ Optimizaciones de rendimiento

### Version 1.5 (Q2 2024)
- üìã Generics
- üìã Pattern matching
- üìã Async/await nativo
- üìã Package manager

### Version 2.0 (Q3 2024)
- üìã Compilaci√≥n JIT
- üìã Language Server Protocol
- üìã WebAssembly target
- üìã Standard library completa

## Contribuir

### Configuraci√≥n del Entorno
```bash
git clone https://github.com/arturoeanton/go-r2lang.git
cd go-r2lang
go mod tidy
go test ./r2lang
```

### Estructura del Proyecto
```
‚îú‚îÄ‚îÄ main.go              # Punto de entrada
‚îú‚îÄ‚îÄ main.r2             # Ejemplo principal
‚îú‚îÄ‚îÄ r2lang/             # Core del int√©rprete
‚îÇ   ‚îú‚îÄ‚îÄ r2lang.go       # Lexer, Parser, AST
‚îÇ   ‚îú‚îÄ‚îÄ r2std.go        # Biblioteca est√°ndar
‚îÇ   ‚îú‚îÄ‚îÄ r2http.go       # Funciones HTTP
‚îÇ   ‚îî‚îÄ‚îÄ ...             # Otras bibliotecas
‚îú‚îÄ‚îÄ examples/           # Ejemplos de c√≥digo
‚îî‚îÄ‚îÄ docs/              # Documentaci√≥n
```

### A√±adir Nuevas Caracter√≠sticas

1. **Nuevos Tokens**: Actualizar constantes en `r2lang.go:17-54`
2. **Sintaxis**: Modificar lexer en `r2lang.go:139-321`
3. **AST Nodes**: Crear structs que implementen `Node` interface
4. **Parsing**: A√±adir l√≥gica en parser `r2lang.go:1662-2331`
5. **Evaluaci√≥n**: Implementar m√©todo `Eval()` en el nodo
6. **Testing**: Crear ejemplos en `examples/`

### A√±adir Bibliotecas Nativas
```go
// r2lang/r2nueva.go
func RegisterNueva(env *Environment) {
    env.Set("nuevaFuncion", BuiltinFunction(func(args ...interface{}) interface{} {
        // Implementaci√≥n
        return resultado
    }))
}

// En r2lang.go:RunCode(), a√±adir:
RegisterNueva(env)
```

## Licencia

Este proyecto est√° bajo la licencia MIT. Ver [LICENSE](../../LICENSE) para m√°s detalles.

## Contacto y Soporte

- **Issues**: [GitHub Issues](https://github.com/arturoeanton/go-r2lang/issues)
- **Documentaci√≥n**: Ver carpeta `docs/`
- **Ejemplos**: Ver carpeta `examples/`

---

*R2Lang - Simplicity meets Power* üöÄ